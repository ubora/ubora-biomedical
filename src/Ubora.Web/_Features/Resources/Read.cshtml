@using Ubora.Web._Features.Resources
@model Ubora.Web._Features.Resources.ResourceReadViewModel

<ul class="nav nav-tabs">
    <li class="nav-item">
        <a class="nav-link active" asp-action="@nameof(ResourcesController.Read)" asp-route-id="@Model.ResourceId">
            Read
        </a>
    </li>
    <li class="nav-item">
        <a class="nav-link" asp-action="@nameof(ResourcesController.Edit)" asp-route-id="@Model.ResourceId">
            Edit
        </a>
    </li>
    <li class="nav-item">
        <a class="nav-link" asp-action="@nameof(ResourcesController.History)" asp-route-id="@Model.ResourceId">
            History
        </a>
    </li>
</ul>

<div class="test">
    <h1 id="asdf">@Model.Title</h1>
    <div id="content-body" data-spy="scroll">@Html.Raw(Model.Body)</div>
</div>

@section Right {
    TABLE OF CONTENTS
    <nav id="content-navigation" class="nav nav-pills flex-column position-sticky" data-spy="scroll" data-target="#content-body">
    </nav>
}

@section Scripts
{
    <script>
//        $('#content-navigation').scrollspy({ target: '#content-body' });
        
        $('#content-body').find('h1').each(function(_, element) {
            $(element).attr('id', Math.floor((Math.random() * 100) + 1).toString());
            $('#content-navigation').append(`<a class="nav-link ml-3 my-1" href="#${$(element).attr('id')}">${escape($(element).text())}</a>`);
            $('#content-navigation').scrollspy('refresh');
        });

    </script>
}